# php栈和堆的区别？



###堆和栈的区别：

·   1> 堆空间的内存是动态分配的,一般存放对象,并且需要手动释放内存。

·   2> 栈空间的内存由系统自动分配,一般存放局部变量等,不需要手动管理内存。



接下来我将从以下几个方面来阐述堆与栈的区别；

###管理方式:

对于栈来讲,由[编译器](https://so.csdn.net/so/search?q=编译器&spm=1001.2101.3001.7020)自动管理,无需我们手动控制。

对于堆来说,释放工作由程序员控制,容易产生memory warning。

###申请大小:

栈:**在Windows下,栈是向低地址扩展的数据结构,是一块连续的内存区域.即栈顶的地址和栈的最大容量是系统预先规好的**。栈的大小是1M,如果申请空间超过栈的剩余空间时,将提示overflow.因此,能从栈获得的空间较小。

堆:**堆是向高地址扩展的数据结构,是不连续的内存区域.这是因为系统是用链表来存储空闲内存地址的,自然是不连续的,而链表的遍历方向是由低地址向高地址.堆得大小受限于计算机系统中有效地虚拟内存.由此可见,堆获得的空间比较灵活,也比较大。**

###碎片问题:

对于堆来讲,频繁的new/delete势必会造成内存空间的不连续,从而造成大量的碎片,使程序效率降低。

对于栈来讲,则不会存在这个问题,因为栈是先进后出得队列,它们是如此的一一对应,以至于永远都不可能有一个内存块从栈中间弹出。

###分配方式:

堆都是动态分配的,没有静态分配的堆。

栈有两种分配方式:静态分配和动态分配.静态分配是编译器完成的,比如局部变量的分配.动态分配由alloc函数进行分配,但是栈的动态分配和堆是不同的,它的动态分配是由编译器进行释放,无需我们手工实现。

###分配效率:

栈是机器系统提供的数据结构,计算机会在底层对栈提供支持:分配专门的寄存器存放栈的地址,压栈出栈都有专门的指令执行,这就决定了栈的效率比较高。

堆则是C/C++函数库提供的,它的机制是很复杂的。