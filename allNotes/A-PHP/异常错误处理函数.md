# 异常错误处理函数



**throw 抛出的任何 异常都是被异常处理函数来捕获的；**



```php


function deal_exception(Exception $e) {
    echo $e->getMessage();
}

set_exception_handler('deal_exception');

throw new Exception('ni cuo le ma ?');// 抛出异常之后就不在往下运行了； 结束了；也就是这里已经报错了；
echo "ceshi";

//try {
//
//    throw new Exception("hha try");
//}catch(Exception $e){
//    echo $e->getMessage();
//}

set_error_handler()// 定制错误处理函数 set_error_handler — Sets a user-defined error handler function
//callback
If null is passed, the handler is reset to its default state. Otherwise, the handler is a callback with the following signature:

handler(
    int $errno,
    string $errstr,
    string $errfile = ?,
    int $errline = ?,
    array $errcontext = ?
): bool
//
    function deal_error($errorCode, $errorMessage, $errorFile, $errorLine) {
    echo "cedsss";
    echo "\n";
    echo $errorCode;
    echo "\n";
    echo $errorMessage;
    echo "\n";
    echo $errorFile;
    echo "\n";
    echo $errorLine;
}
set_error_handler('deal_error');

//结果 错误处理的结果；
cedsss
2
Use of undefined constant dssklsjslksjlks - assumed 'dssklsjslksjlks' (this will throw an Error in a future version of PHP)
/opt/project/Project/Index.php
391
    
```





一些基础的设置；

```php
error_reporting(E_ALL & ~E_NOTICE & ~E_WARNING & ~E_STRICT);
ini_set('display_errors', false);
// 无需浏览器缓存
header("Cache-Control: no-cache, must-revalidate");
header("Expires: Sat, 26 Jul 1997 05:00:00 GMT");
// 设置时区和编码
date_default_timezone_set('Asia/Shanghai');
setlocale(LC_ALL, 'en_US.utf-8');
header('Content-type:text/html;charset=utf-8');
// 设置错误捕获机制
set_error_handler('\MeiTu\Frame\Init::errorHandler');
set_exception_handler('\MeiTu\Frame\Init::exceptionHandler');
```





### 为什么set_exception_handler(); 可以设置异常处理函数还要用try{}catch(Exception \$e){}





**可以选择不同的异常处理方案；** 就是方案和 异常处理函数都是那么处理的，但是使用try catch 可以，选择不同的异常处理方案；



`````php
/**
 * exception  try catch
 * try catch 处理一些 特殊的异常抛出请求；
*/
function deal(Exception $e){
    echo $e->getMessage();
}
set_exception_handler('deal');

//throw new Exception('wocuole');

try{
    throw new Exception('wo zhen de cuowle ','1111');
}catch (Exception $e) {
    //  会运行这个; try catch 优先级 高于 异常处理函数的；
    echo $e->getMessage()."---".$e->getCode();
}

`````







