# php生命周期

根据sapi可以分为php-fpm模式和cli模式

主要分为五个模块 

1. 模块初始化：创建进程， 主要是加载php.ini 和扩展模块,zend引擎的初始化；初始化环境；初始化SAPI；

2. 

   ```
   该阶段的主要作用是初始化变量、常量；注册各种函数，比如工具、词法、语法函数等；解析配置文件；加载扩展；
   ```

3. 请求初始化，全局变量和静态变量的初始化，处理请求信息；对于fpm，对每个worker进程在接收一个请求且获取，解析完成请求数据后的阶段；

   

4. 执行php  编译和执行；

   php代码通过词法和语法解析生成opcode opcode然后再zend虚拟机上执行的过程 zend_executed()

5. 请求shutdown；

   关闭编译器和执行器把，输出缓存区的内容flush全部输出；销毁全局变量；

```
请求关闭阶段主要内容是调用各模块的关闭函数和析构函数、输出缓冲区内容、调用各扩展的钩子函数RSHUTDOWN、关闭编译器和执行器以及还原PHP配置等。
```

1. 模块shutdown；

2. ```
   它的主要作用是调用模块的flush函数、清理符号表、销毁全局变量、关闭内存管理和垃圾回收、关闭输出等。
   
   在关闭所有的模块后，PHP继续销毁全局函数表，销毁全局类表、销售全局变量表等。
   ```
   
   \$_SESSION  的跨页面的原理 就是在服务器用一个文件形式来保存，就是一个数据库，只要拿到cookie PHPSESSION 就可以从这个文件数据库来获取数据；
