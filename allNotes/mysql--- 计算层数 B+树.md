# mysql--- 计算层数 B+树

**注意：在二叉树中可以用整个公式计算层数 lgM=H  H=树高，M是结点数；**

  **二叉树 结点数就是数据数，B+数结点数和数据条数不同；**



计算非叶子结点的指针数（他是几叉树）假如主键索引是bigint（8字节）+ 指针的大小一般是6字节（8个字节；）；  跟操作系统有关系；8个字节；

##  注意这里是两个条件 不然没法计算； （这里是条件）

**innodb_page_size = 16kB，那么指针数就是16*1024/14=1170；**

**假如一条数据大约是1KB，那么一个叶子几点大约能存16条数据；**



假设有1000w条数据

1170^H*16 = 10000000



树存储的数据条数，由叶子结点来决定；也就是 假如一条数据1kb那么一个叶子结点可以由16条数据；

1170^H = 叶子节点数    =》 **1170^H*16 ；叶子结点含有的数据条数**



1170^H *16= 10000000







层级= high+1；层是1开始的；**高度是从0开始的，所以高度是多少就会进行多少次随机IO口的访问；**



**所以在 InnoDB 中 B+ 树高度一般为 1-3 层，它就能满足千万级的数据存储。**

在查找数据时一次页的查找代表一次 IO，所以通过主键索引查询通常只需要 1-3 次 IO 操作即可查找到数据。



所以 当3层的时候可以存储 **16\*1170\*1170 = 21902400;****可以存储2000w多条数据；**





````php
#  首先注意的是   ----  注意这个计算方式；   ### 注意我这里仅仅是做了一个预算  页地址 是4个字节；

x= 1280页；做一个模糊计算把；
    
N叉树 求N = 16000B/（8 + 8） = 1000叉树
//假如每一条消息是 1KB/所以；
（1000）^h * 16 =  1 * 10000000 = > (1000)^h = 62500;
h= log1000 625000;

1000 * 1000 * 16 = 1600wkB 也就是  1600w多条数据； 
#树 的高度是2 但是层级确是3；3层；
#尽量不让树的高度超过  4层；
````



