# 真正的中间人攻击



----



###charles 可以进行https 抓包的原理！！！

>**一般CA证书机构的公钥，为了防止传输过程中被篡改，一般会保存在操作系统内核！！！**
>
>**客户端使用 CA 证书来验证服务器的身份和信任**
>
>**客户端可信任的 CA 证书是公钥，而不是私钥。**

文字描述：

这是由CA的一种攻击方式！！

 首先我们使用charles，我们要先安装charlesCA证书，其实就是charles CA的公钥！！！

中间人攻击攻击的是客户端向服务器端申请公钥的一个过程！！

当客户端去服务端申请公钥被charles拦截，没有做任何的修改，然后给发送给服务器；

服务器就会把用真正的CA加密的服务器公钥发送给charles，charles也有真正的CA的公钥，然后进行解密拿到服务器的公钥，

拿到公钥然，之后替换里面公钥换成自己的公钥，用自己的charlesCA私钥进行加密；

加密之后传给客户端， 客户端是由charles的信任证书做解密，拿到charles的公钥；

然后用公钥进行加密和服务端去协商key，被charles捕获，然后用charles私钥解密，拿到key，然后用服务器公钥加密传送给服务器；



然后charles就知道key了。以后的加密都对中间人charles 都是透明的数据传输；





---

###没有CA的中间人攻击方式：

----



**中间人会攻击客户端第一次去服务端申请公钥的过程！！！**

**客户端拿到的公钥并不是服务器的公钥，是中间人的公钥，所以接下来的数据传输对于中间人来说都是透明传输！！！**

服务器的公钥都有！！！

**传输过程就是 客户端用中间人的公钥进行加密，然后中间人捕获到，然后用自己的私钥进行解密，再用服务端的公钥进行加密，传送给服务端，这就实现了一个中间人攻击！！！**



