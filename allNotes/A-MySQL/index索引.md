# 索引index

>---
>
>
>
>**索引的本质就是一个数据结构！！！**
>
>---
>
>
>
>是否能使用索引就是判断，这个字段存储的时候是否是有序的；
>
>就像一本书，如果有序，那么就可以又目录（index），来加速查询；
>
>但是如果一本书，是乱序的，那么我们查找，只能从第一页开始一页一页的遍历；
>
>官方文档大法好    dev.mysql.com



##  关于 联合索引不能使用索引的解析

联合索引的结构；为什么 a > 0 and b = 3 不能使用索引；

假设 a 字段代表的是一个大章节，b代表小章节；

 很明显 a >的时候b不是有序的，所以肯定不能使用索引，但是a可以使用索引；

a   b

1    1

1     2

1     3

1    4

2    1

2    2

2     3

3    4  



##  关于or 不能使用索引的解析      union       in  的区别



sql中常用union all对数据集进行合并
union 是带去重功能的
or也带去重功能

select device_id,	gender	,age	,gpa
from user_profile
where university='山东大学' or gender='male';

------

使用union代替or，解决or导致全表扫描

select device_id,	gender	,age	,gpa
from user_profile
where university='山东大学' 
union 
select device_id,	gender	,age	,gpa
from user_profile
where gender='male';



---

**Developer/Programmer (vscode-openai)** Date: 12/3/2023, 6:36:00 PM

在某些情况下，`OR` 运算符可能无法有效使用索引，这是由于以下原因：

1. **索引选择性：`OR` 运算符通常会导致索引选择性下降。索引选择性是指索引中不同值的唯一性和重复性的比率。当使用 `OR` 运算符时，查询需要匹配多个条件，这可能会导致索引选择性下降，使得优化器认为全表扫描比使用索引更高效。**
2. **索引结构：某些索引结构不适合处理 `OR` 运算符。例如，B树索引是一种常见的索引结构，它在处理范围查询时非常高效，但对于 `OR` 运算符，它可能需要进行多次索引查找，导致性能下降。**
3. **查询优化器：查询优化器在决定使用索引还是全表扫描时会考虑多个因素，包括索引选择性、查询成本估算等。当查询中包含 `OR` 运算符时，优化器可能会认为全表扫描比使用索引更高效，从而选择全表扫描。**

**虽然 `OR` 运算符可能无法使用索引，但可以尝试使用其他优化技术来改善查询性能，例如使用联合索引、优化查询语句结构等。**

-----





## mysql中or和in的效率问题

1. in或or在字段有添加索引的情况下，查询很快，两者查询速度没有什么区别；
2. in或or在字段没有添加索引的情况下,所连接的字段越多(1or2or3or4or......)，or比in的查询效率低很多，or的效率为O(n)，而in的效率为O(logn)



为何推荐在没有索引的情况下使用in呢？   

- OR，就是从a1匹配，匹配失败，去匹配a2，直到匹配成功或者一个都匹配不上，时间复杂度O(n)
- IN,会对这个字段来进行排序，然后用二分法，来查找；所以效率是logn



---



1. **选择合适的列**：选择经常用于查询条件、连接条件或排序的列进行索引。这些列通常包括主键、外键、经常出现在 WHERE 子句中的列以及经常用于连接的列。
2. **避免过度索引**：不要为每个列都创建索引。过多的索引可能会导致维护成本增加，并且在写操作时可能会降低性能。
3. **考虑索引的顺序**：对于涉及多个列的查询，考虑创建复合索引，以便索引可以更好地支持这些查询。索引的顺序应该与查询条件的顺序相匹配。
4. **注意索引的大小**：索引的大小会影响查询性能和存储空间。尽量选择较小的数据类型作为索引列，以减少索引的大小。
5. **定期维护索引**：定期检查和维护索引，包括删除不再需要的索引、重新构建索引以减少碎片化等操作。
6. **考虑使用覆盖索引**：覆盖索引是一种包含了查询所需的所有列的索引，可以减少对数据表的访问，提高查询性能。

----

